<!--
BSD 3-Clause License
Copyright (c) 2020, Justin Lyon
All rights reserved.
/*
Change History
****************************************************************************************************
ModifiedBy      Date        Jira No.    Tag     Description
****************************************************************************************************
Isha Bansal     30/06/2023  I2RT-8234   T01    Removed label, handled default value ,icon population and null checks  
*/
-->
<template>
  <div class="slds-form-element">

    <div class="slds-form-element__control">
      <div class={containerClasses}>

        <div class={comboboxClasses}
          aria-expanded={showListbox}
          aria-haspopup="listbox"
          role="combobox">

          <div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left-right"
            role="none">
            <span if:true={record}
              class="slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_left">
              <lightning-icon
                size="x-small"
                icon-name={iconName}></lightning-icon>
            </span>
            <span if:false={record}
              class="slds-icon_container slds-icon-utility-search slds-input__icon slds-input__icon_left">
              <lightning-icon
                size="x-small"
                icon-name="utility:search"></lightning-icon>
            </span>
            <input type="search"
              id="searchInput"
              class={inputClasses}
              value={inputValue}
              onkeyup={onKeyup} 
              oninput={input}            
              onfocus={setFocus}
              onblur={setFocus}
              minlength="3"
              pattern="[a-zA-Z]*"
              autocomplete="off"
              aria-autocomplete="list"
              aria-controls="searchInput"
              role="textbox"
              readonly={isReadOnly}
              required={required}
              placeholder={placeholder}>

            <button if:true={showClear}
              onclick={clearSelection}
              class="slds-button slds-button_icon slds-input__icon slds-input__icon_right"
              title="Remove selected option">
              <lightning-icon
                size="x-small"
                icon-name="utility:close"></lightning-icon>
              <span class="slds-assistive-text">Remove selected option</span>
            </button>
          </div>

          <div if:true={hasError} class="slds-form-element__help">
            {error.message}
          </div>

          <div if:true={showListbox} class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid"
            role="listbox">
            <c-global-listbox
              records={records}
              title={title}
              active-id={activeId}
              subtitle={subtitle}
              icon-name={iconName}
              onselected={handleSelected} ></c-global-listbox>
          </div>
             
        </div>
      </div>
    </div>
  </div>
</template>